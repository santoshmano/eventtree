{% extends "base.html" %}

{% block title %}
  Select a package for {{ event.name }}
{% endblock %}

{% block content %}
  <main class="user-body">
    <div class="container">
      <h1>
        {{ event.name }}
      </h1>

      {% comment %}Start - For later , do this if a If Package is
        Selected/payment is
        made/booking is confirmed etc.
        {% endcomment %}

        <div class="container">
          <h2> Invite </h2>



          <div class="table-responsive"> 
          <table class="table table-hover table-condensed ">
            <thead>
              <tr>
                <th>Name</th>
                <th>Attending?</th>
                <th>#Adults</th>
                <th>#Children</th>
                <th>Email</th>
                <th>Message</th>
              </tr>
            </thead>

            <tbody>
            {% for invitee in event.invite.invites.all %}
              <tr>
                <td>{{ invitee.full_name }}</td>
                <td>{{ invitee.attending }}</td>
                <td>{{ invitee.num_of_adults }}</td>
                <td>{{ invitee.num_of_children }}</td>
                <td>{{ invitee.email }}</td>
                <td>{{ invitee.message }}</td>
              </tr>
            {% endfor %}
            </tbody>
          </table>
          {% if not event.invite.invites.count %}
            <div class="alert alert-info">
                No RSVP's received so far
            </div>
          {% endif %}
          </div>

          <div>
            <strong>TODO: autocalculate </strong>19 adults and 20 children, are
              coming. 3
              adults
                and 4
                children, may come. 4 invitees responded as not coming<br/>
          </div>
          <br> 

          <div>

          {% if not event.invite %}
              {% if event.can_invite %}
                Click on this link to
                <a href="{% url 'send_event_invite' event.slug %}"> send
                  the invite email </a>to your
                  registered email account.<br/>
              {% else %}
                Kindly select a package {{ event.booking.status }}.
              {% endif %}
          {% comment %} Change the ability to invite only after booking is confirmed or is in progress {% endcomment %}
          {% else %}
                Click on this link to <a href="{% url 'send_event_invite' event.slug %}">re-send the invite email </a>to your registered email account.<br/>
          {% endif %}
          </div>
          {% comment %}
          End For later , do this if a If Package is
            Selected/payment is
            made/booking is confirmed etc.
          {% endcomment %}
        </div>

      <div class="container">
        <h2>
          Packages
        </h2>

        <div>
          {% if event.booking.count %}
            You have selected Package <strong>{{ event.booking.first.package.name }}</strong> for your event. Kindly email/call us if you want any changes.
          {% else %}
            Please look at your different options and Confirm a certain packages. Kindly email/call us if you want any changes to a package.
          {% endif %}
        </div>
        <br/>
        <div>
          <ul class="nav nav-tabs" role="tablist">
            {% for package in event.packages.all %}
              <li role="presentation" class="{% if forloop.first %}active{% endif %}">
                <a href="#{{ package.name}}" aria-controls="{{ package.name}}" role="tab" data-toggle="tab">{{ package.name}}</a>
              </li>
            {% endfor %}
          </ul>
          <div class="tab-content">
            {% for package in event.packages.all %}
              <div role="tabpanel" class="tab-pane {% if forloop.first %}active{% endif %}" id="{{ package.name}}">
                {% include 'packages/'|add:package.filename %}
              </div>
            {% endfor %}
          </div>
        </div>
      </div>
    </div>
  </main>
{% endblock %}
